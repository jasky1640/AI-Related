### Written Homework 5

#### Jiaqi Yang (jxy530)

#### Due November 26th, Tuesday

------

> Q1. Bernoulli trials and bias beliefs
> Recall the binomial distribution describing the likelihood of getting y heads for n flips
>
> ![1574783594679](C:\Users\jasky\AppData\Roaming\Typora\typora-user-images\1574783594679.png)
>
> where θ is the probability of heads.

###### a) Using the fact (following equation) derive the posterior distribution for µ assuming a uniform prior. 

![1574783667295](C:\Users\jasky\AppData\Roaming\Typora\typora-user-images\1574783667295.png)

![1574786247728](C:\Users\jasky\AppData\Roaming\Typora\typora-user-images\1574786247728.png)

###### b) Plot the likelihood for n =4 and θ =3/4. Make sure your plot includes y = 0.

The graph of P(y|θ , n): 

![1574786498889](C:\Users\jasky\AppData\Roaming\Typora\typora-user-images\1574786498889.png)

###### c) Plot the posterior distribution of θ after each of the following coin flips: head, head, tail, head. You should have four plots total.

Plot 1:

![1574786708328](C:\Users\jasky\AppData\Roaming\Typora\typora-user-images\1574786708328.png)

Plot 2:

![1574786745296](C:\Users\jasky\AppData\Roaming\Typora\typora-user-images\1574786745296.png)

Plot 3:

![1574786751800](C:\Users\jasky\AppData\Roaming\Typora\typora-user-images\1574786751800.png)

Plot 4:

![1574786757993](C:\Users\jasky\AppData\Roaming\Typora\typora-user-images\1574786757993.png)

------

> Q2. After R&N 20.1 Bags O’ Surprise
> The data used for Figure 20.1 on page 804 can be viewed as being generated by h5.

###### a) For each of the other four hypotheses, write code to generate a data set of length 100 and plot the corresponding graphs for P(h<sub>i</sub>|d<sub>1</sub>,...,d<sub>N</sub>) and P(D<sub>N+1</sub> = lime|d<sub>1</sub>,...,d<sub>N</sub>). The plots should follow the
format of Figure 20.1. Comment on your results. 

Graph of P(h<sub>i</sub>|d<sub>1</sub>,...,d<sub>N</sub>) and P(D<sub>N+1</sub> = lime|d<sub>1</sub>,...,d<sub>N</sub>) for h4

![1574788672303](C:\Users\jasky\AppData\Roaming\Typora\typora-user-images\1574788672303.png)

![1574788679046](C:\Users\jasky\AppData\Roaming\Typora\typora-user-images\1574788679046.png)

Graph of P(h<sub>i</sub>|d<sub>1</sub>,...,d<sub>N</sub>) and P(D<sub>N+1</sub> = lime|d<sub>1</sub>,...,d<sub>N</sub>) for h3

![1574788690599](C:\Users\jasky\AppData\Roaming\Typora\typora-user-images\1574788690599.png)

![1574788697295](C:\Users\jasky\AppData\Roaming\Typora\typora-user-images\1574788697295.png)

Graph of P(h<sub>i</sub>|d<sub>1</sub>,...,d<sub>N</sub>) and P(D<sub>N+1</sub> = lime|d<sub>1</sub>,...,d<sub>N</sub>) for h2

![1574788934703](C:\Users\jasky\AppData\Roaming\Typora\typora-user-images\1574788934703.png)

![1574788958967](C:\Users\jasky\AppData\Roaming\Typora\typora-user-images\1574788958967.png)

Graph of P(h<sub>i</sub>|d<sub>1</sub>,...,d<sub>N</sub>) and P(D<sub>N+1</sub> = lime|d<sub>1</sub>,...,d<sub>N</sub>) for h1

![1574788964471](C:\Users\jasky\AppData\Roaming\Typora\typora-user-images\1574788964471.png)

![1574788974310](C:\Users\jasky\AppData\Roaming\Typora\typora-user-images\1574788974310.png)

In my program (w5_2a.m), instead of randomly generating, I generate the cheery candy as every fourth candy, so therefore there is a spike exists in every n = 4k. However, as n grows larger than 20 to 40, the graph becomes smoother.  

In conclusion, the plot fits our expectation since as more experiments have been conducted, the guesswork becomes more accurate. For example, in the case of h4, for n > 40, it is almost certain that the bag is an h4 bag and the next candy is 75% possible to be a lime candy. Similar observations could be made in h3, h2, h1 scenarios.

###### b) What is the mathematical expression for how many candies you need to unwrap before you are more 90% sure which type of bag you have?

![1574793731598](C:\Users\jasky\AppData\Roaming\Typora\typora-user-images\1574793731598.png)

![1574793737634](C:\Users\jasky\AppData\Roaming\Typora\typora-user-images\1574793737634.png)

###### c) Make a plot that illustrates the reduction in variability of the curves for the posterior probability for each type of bag by averaging each curve obtained from multiple datasets.

The graph of h4 posterior distribution with 1 dataset

![1574788672303](C:\Users\jasky\AppData\Roaming\Typora\typora-user-images\1574788672303.png)

The graph of h4 posterior with 500 datasets 

![1574808498105](C:\Users\jasky\AppData\Roaming\Typora\typora-user-images\1574808498105.png)

The graph of h3 posterior distribution with 1 dataset

![1574788690599](C:\Users\jasky\AppData\Roaming\Typora\typora-user-images\1574788690599.png)

The graph of h3 posterior with 500 datasets 

![1574808598339](C:\Users\jasky\AppData\Roaming\Typora\typora-user-images\1574808598339.png)

The graph of h2 posterior distribution with 1 dataset

![1574788934703](C:\Users\jasky\AppData\Roaming\Typora\typora-user-images\1574788934703.png)

The graph of h2 posterior with 500 datasets 

![1574808624514](C:\Users\jasky\AppData\Roaming\Typora\typora-user-images\1574808624514.png)

The graph of h1 posterior distribution with 1 dataset

![1574788964471](C:\Users\jasky\AppData\Roaming\Typora\typora-user-images\1574788964471.png)

The graph of h1 posterior with 500 datasets 

![1574808650386](C:\Users\jasky\AppData\Roaming\Typora\typora-user-images\1574808650386.png)

It is clear that we could observe with more datasets, the curve becomes smoother, while the zigzag disappears. During my experiments, the zigzag decreases visually when the dataset increases from 1 to 10 to 100 to 500. However, the only exception is h1' case, which not matter we have 1 dataset or 500 datasets, the posterior distribution is almost same and smooth.

------

> Q3. k-means Clustering 
>  In k-means clustering, µk is the vector mean of the k<sup>th</sup> cluster. Assume the data vectors have I dimensions, so µ<sub>k</sub> is a (column) vector [µ<sub>1</sub>,...,µ<sub>I</sub> ] <sup>T</sup><sub> k</sub> , where the symbol <sup>T</sup> indicates vector transpose. 

###### a)  Derive update rule for µ<sub>k</sub> using the objective function 

![1574784364416](C:\Users\jasky\AppData\Roaming\Typora\typora-user-images\1574784364416.png)

![1574795403559](C:\Users\jasky\AppData\Roaming\Typora\typora-user-images\1574795403559.png)